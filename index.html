<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ö–µ–≥–µ–ª—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #1a1a1a;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: white;
        }

        .container {
            background: #1a1a1a;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #ff3b30;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* Setup Screen */
        .setup-info {
            background: #2a2a2a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .setup-info h3 {
            color: #ff3b30;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .setup-info p {
            color: #999;
            line-height: 1.6;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .duration-selector {
            margin-bottom: 25px;
        }

        .duration-selector label {
            display: block;
            color: #ddd;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .duration-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .duration-btn {
            padding: 15px;
            border: 2px solid #333;
            background: #2a2a2a;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            color: #ddd;
        }

        .duration-btn:hover {
            border-color: #ff3b30;
            background: #333;
        }

        .duration-btn.selected {
            border-color: #ff3b30;
            background: #ff3b30;
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #ff3b30;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .daily-progress {
            background: #2a2a2a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
        }

        .daily-progress h3 {
            color: #ddd;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .progress-circles {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .progress-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            font-size: 18px;
        }

        .progress-circle.completed {
            background: #ff3b30;
            border-color: #ff3b30;
            color: white;
        }

        /* Workout Screen */
        .exercise-header {
            background: #2a2a2a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .exercise-progress {
            color: #ff3b30;
            font-size: 14px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .exercise-name {
            font-size: 24px;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
        }

        .exercise-description {
            font-size: 13px;
            color: #999;
            line-height: 1.5;
        }

        .timer-container {
            text-align: center;
            margin: 30px 0;
            position: relative;
        }

        /* Circular Progress */
        .circular-progress {
            width: 300px;
            height: 300px;
            margin: 0 auto;
            position: relative;
        }

        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            transition: stroke-dashoffset 1s linear;
            stroke: #ff3b30;
            stroke-width: 8;
            fill: none;
        }

        .progress-ring-bg {
            stroke: #2a2a2a;
            stroke-width: 8;
            fill: none;
        }

        .timer-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 250px;
            height: 250px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.4s ease;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .timer-circle.squeeze {
            background: radial-gradient(circle at center, #ff3b30 0%, #8b0000 100%);
            animation: pulse 1s ease-in-out;
        }

        .timer-circle.relax {
            background: radial-gradient(circle at center, #333 0%, #1a1a1a 100%);
        }

        .timer-circle.rest {
            background: radial-gradient(circle at center, #444 0%, #222 100%);
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
        }

        .phase-label {
            font-size: 18px;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.9;
        }

        .time-display {
            font-size: 72px;
            font-weight: bold;
            color: white;
            font-variant-numeric: tabular-nums;
            line-height: 1;
        }

        .time-unit {
            font-size: 18px;
            color: rgba(255,255,255,0.7);
            margin-top: 5px;
        }

        /* Exercise List */
        .exercise-list {
            background: #2a2a2a;
            border-radius: 15px;
            padding: 15px;
            margin-top: 25px;
            max-height: 200px;
            overflow-y: auto;
        }

        .exercise-list h4 {
            color: #ff3b30;
            font-size: 14px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .exercise-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #333;
        }

        .exercise-item:last-child {
            border-bottom: none;
        }

        .exercise-item-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 12px;
            color: #999;
        }

        .exercise-item.current .exercise-item-icon {
            background: #ff3b30;
            color: white;
        }

        .exercise-item.completed .exercise-item-icon {
            background: #444;
            color: #666;
        }

        .exercise-item-name {
            flex: 1;
            font-size: 14px;
            color: #ddd;
        }

        .exercise-item.current .exercise-item-name {
            color: white;
            font-weight: bold;
        }

        .exercise-item.completed .exercise-item-name {
            color: #666;
            text-decoration: line-through;
        }

        .exercise-item-duration {
            font-size: 12px;
            color: #999;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: #ff3b30;
            color: white;
            flex: 1;
        }

        .btn-primary:hover:not(:disabled) {
            background: #ff5247;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 59, 48, 0.4);
        }

        .btn-secondary {
            background: #333;
            color: white;
            flex: 1;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #444;
            transform: translateY(-2px);
        }

        .btn-skip {
            background: #2a2a2a;
            color: #999;
            padding: 15px 20px;
        }

        .btn-skip:hover:not(:disabled) {
            background: #333;
            transform: translateY(-2px);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Completion Screen */
        .completion-message {
            text-align: center;
            padding: 20px;
        }

        .completion-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .completion-message h2 {
            color: #ff3b30;
            font-size: 32px;
            margin-bottom: 15px;
        }

        .completion-message p {
            color: #999;
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        @media (max-width: 480px) {
            .container {
                padding: 25px;
            }

            h1 {
                font-size: 24px;
            }

            .circular-progress {
                width: 250px;
                height: 250px;
            }

            .timer-circle {
                width: 200px;
                height: 200px;
            }

            .time-display {
                font-size: 56px;
            }

            .phase-label {
                font-size: 16px;
            }

            .duration-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Scrollbar styling */
        .exercise-list::-webkit-scrollbar {
            width: 6px;
        }

        .exercise-list::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 10px;
        }

        .exercise-list::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 10px;
        }

        .exercise-list::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ö–µ–≥–µ–ª—è</h1>
        
        <!-- Setup Screen -->
        <div id="setup-screen" class="screen active">
            <div class="daily-progress">
                <h3>–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–µ–≥–æ–¥–Ω—è</h3>
                <div class="progress-circles">
                    <div class="progress-circle" id="session1">1</div>
                    <div class="progress-circle" id="session2">2</div>
                </div>
            </div>

            <div class="duration-selector">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</label>
                <div class="duration-options">
                    <button class="duration-btn" onclick="selectDuration(25)">25 —Å–µ–∫</button>
                    <button class="duration-btn selected" onclick="selectDuration(35)">35 —Å–µ–∫</button>
                    <button class="duration-btn" onclick="selectDuration(45)">45 —Å–µ–∫</button>
                    <button class="duration-btn" onclick="selectDuration(60)">60 —Å–µ–∫</button>
                    <button class="duration-btn" onclick="selectDuration(90)">90 —Å–µ–∫</button>
                    <button class="duration-btn" onclick="selectDuration(120)">2 –º–∏–Ω</button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">6</div>
                    <div class="stat-label">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="estimated-time">~4</div>
                    <div class="stat-label">–ú–∏–Ω—É—Ç—ã</div>
                </div>
            </div>

            <div class="setup-info">
                <h3>–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</h3>
                <p>‚Ä¢ <strong>Trembling</strong> - –ë—ã—Å—Ç—Ä—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è (1—Å —Å–∂–∞—Ç–∏–µ / 1—Å —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ)</p>
                <p>‚Ä¢ <strong>Starter</strong> - –ë—ã—Å—Ç—Ä–æ–µ + —É–¥–µ—Ä–∂–∞–Ω–∏–µ (–±—ã—Å—Ç—Ä–æ, –∑–∞—Ç–µ–º 3—Å —É–¥–µ—Ä–∂–∞–Ω–∏–µ)</p>
                <p>‚Ä¢ <strong>Short Holding</strong> - –ö–æ—Ä–æ—Ç–∫–∏–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è (3—Å —Å–∂–∞—Ç–∏–µ / 3—Å –æ—Ç–¥—ã—Ö)</p>
                <p>‚Ä¢ <strong>Steady Trembling</strong> - –†–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –ø—É–ª—å—Å–∞—Ü–∏–∏ (2—Å —Å–∂–∞—Ç–∏–µ / 1—Å –æ—Ç–¥—ã—Ö)</p>
                <p>‚Ä¢ <strong>Front Clamp</strong> - –ü–µ—Ä–µ–¥–Ω–∏–µ –∑–∞–∂–∏–º—ã (–º–∞–∫—Å–∏–º—É–º / —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ)</p>
                <p>‚Ä¢ <strong>Back Clamp</strong> - –ó–∞–¥–Ω–∏–µ –∑–∞–∂–∏–º—ã (–º–∞–∫—Å–∏–º—É–º / —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ)</p>
            </div>

            <div class="controls">
                <button class="btn-primary" onclick="startWorkout()">–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
            </div>
        </div>

        <!-- Workout Screen -->
        <div id="workout-screen" class="screen">
            <div class="exercise-header">
                <div class="exercise-progress" id="exercise-progress">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1 –∏–∑ 6</div>
                <div class="exercise-name" id="exercise-name">Trembling</div>
                <div class="exercise-description" id="exercise-description">–ë—ã—Å—Ç—Ä—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –º—ã—à—Ü</div>
            </div>

            <div class="timer-container">
                <div class="circular-progress">
                    <svg class="progress-ring" width="300" height="300">
                        <circle class="progress-ring-bg" cx="150" cy="150" r="140"></circle>
                        <circle class="progress-ring-circle" cx="150" cy="150" r="140" 
                                id="progress-circle" 
                                stroke-dasharray="879.646" 
                                stroke-dashoffset="879.646"></circle>
                    </svg>
                    <div class="timer-circle" id="timer-circle">
                        <div class="phase-label" id="phase-label">–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å</div>
                        <div class="time-display" id="time-display">3</div>
                        <div class="time-unit">—Å–µ–∫</div>
                    </div>
                </div>
            </div>

            <div class="exercise-list">
                <h4>–ü–ª–∞–Ω —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</h4>
                <div id="exercise-list-items"></div>
            </div>

            <div class="controls">
                <button class="btn-secondary" id="pause-btn" onclick="togglePause()">–ü–∞—É–∑–∞</button>
                <button class="btn-skip" onclick="skipExercise()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
        </div>

        <!-- Completion Screen -->
        <div id="completion-screen" class="screen">
            <div class="completion-message">
                <div class="completion-icon">üéâ</div>
                <h2>–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!</h2>
                <p>–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É!<br>–ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ç–æ—Ä—É—é —Å–µ—Å—Å–∏—é —Å–µ–≥–æ–¥–Ω—è.</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-time">0:00</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">6</div>
                    <div class="stat-label">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>
                </div>
            </div>

            <div class="controls">
                <button class="btn-primary" onclick="restartWorkout()">–ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
            </div>
        </div>
    </div>

    <script>
        // Exercise definitions
        const exercises = [
            {
                name: "Trembling",
                description: "–ë—ã—Å—Ç—Ä—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –º—ã—à—Ü",
                fullDescription: "–°–æ–∫—Ä–∞—â–∞–π—Ç–µ –∏ —Ä–∞—Å—Å–ª–∞–±–ª—è–π—Ç–µ –º—ã—à—Ü—ã —Ç–∞–∑–æ–≤–æ–≥–æ –¥–Ω–∞ –≤ —Ä–∏—Ç–º–µ –≤–∏–±—Ä–∞—Ü–∏–∏",
                pattern: [
                    { phase: "squeeze", duration: 1, label: "–°–∂–∞—Ç—å" },
                    { phase: "relax", duration: 1, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" }
                ]
            },
            {
                name: "Starter",
                description: "–ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ + —É–¥–µ—Ä–∂–∞–Ω–∏–µ",
                fullDescription: "–ë—ã—Å—Ç—Ä–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ –∏ —Ä–∞—Å—Å–ª–∞–±—å—Ç–µ, –∑–∞—Ç–µ–º —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 3 —Å–µ–∫—É–Ω–¥—ã",
                pattern: [
                    { phase: "squeeze", duration: 1, label: "–°–∂–∞—Ç—å" },
                    { phase: "relax", duration: 1, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" },
                    { phase: "squeeze", duration: 3, label: "–°–∂–∞—Ç—å –∏ –¥–µ—Ä–∂–∞—Ç—å" },
                    { phase: "relax", duration: 3, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" }
                ]
            },
            {
                name: "Short Holding",
                description: "–ö–æ—Ä–æ—Ç–∫–∏–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è",
                fullDescription: "–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –º—ã—à—Ü—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∏–ª—å–Ω–æ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 3 —Å–µ–∫—É–Ω–¥—ã",
                pattern: [
                    { phase: "squeeze", duration: 3, label: "–°–∂–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ" },
                    { phase: "relax", duration: 3, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" }
                ]
            },
            {
                name: "Steady Trembling",
                description: "–†–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –ø—É–ª—å—Å–∞—Ü–∏–∏",
                fullDescription: "–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –º—ã—à—Ü—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∏–ª—å–Ω–æ, —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 2 —Å–µ–∫—É–Ω–¥—ã, –∑–∞—Ç–µ–º –æ—Ç–¥—ã—Ö–∞–π—Ç–µ 1 —Å–µ–∫—É–Ω–¥—É",
                pattern: [
                    { phase: "squeeze", duration: 2, label: "–°–∂–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ" },
                    { phase: "relax", duration: 1, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" }
                ]
            },
            {
                name: "Front Clamp",
                description: "–ü–µ—Ä–µ–¥–Ω–∏–µ –∑–∞–∂–∏–º—ã",
                fullDescription: "–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –ø–µ—Ä–µ–¥–Ω–∏–µ –º—ã—à—Ü—ã —Ç–∞–∑–æ–≤–æ–≥–æ –¥–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∏–ª—å–Ω–æ",
                pattern: [
                    { phase: "squeeze", duration: 3, label: "–ü–µ—Ä–µ–¥–Ω–∏–π –∑–∞–∂–∏–º" },
                    { phase: "relax", duration: 3, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" }
                ]
            },
            {
                name: "Back Clamp",
                description: "–ó–∞–¥–Ω–∏–µ –∑–∞–∂–∏–º—ã",
                fullDescription: "–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –∑–∞–¥–Ω–∏–µ –º—ã—à—Ü—ã —Ç–∞–∑–æ–≤–æ–≥–æ –¥–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∏–ª—å–Ω–æ",
                pattern: [
                    { phase: "squeeze", duration: 3, label: "–ó–∞–¥–Ω–∏–π –∑–∞–∂–∏–º" },
                    { phase: "relax", duration: 3, label: "–†–∞—Å—Å–ª–∞–±–∏—Ç—å" }
                ]
            }
        ];

        // State management
        let selectedDuration = 35; // default
        let workoutSequence = [];
        let currentExerciseIndex = 0;
        let currentPatternIndex = 0;
        let timeRemaining = 0;
        let isPaused = false;
        let isResting = false;
        let timerInterval = null;
        let totalElapsedTime = 0;
        let exerciseStartTime = 0;
        let exerciseElapsedTime = 0;
        let sessionsCompleted = 0;
        let totalExerciseTime = 0;

        // Circular progress configuration
        const circumference = 2 * Math.PI * 140; // radius = 140

        // Load progress from localStorage
        function loadProgress() {
            const today = new Date().toDateString();
            const savedDate = localStorage.getItem('lastWorkoutDate');
            
            if (savedDate === today) {
                sessionsCompleted = parseInt(localStorage.getItem('sessionsCompleted') || '0');
            } else {
                sessionsCompleted = 0;
                localStorage.setItem('lastWorkoutDate', today);
                localStorage.setItem('sessionsCompleted', '0');
            }
            
            updateProgressDisplay();
        }

        function updateProgressDisplay() {
            if (sessionsCompleted >= 1) {
                document.getElementById('session1').classList.add('completed');
            }
            if (sessionsCompleted >= 2) {
                document.getElementById('session2').classList.add('completed');
            }
        }

        function saveProgress() {
            sessionsCompleted++;
            localStorage.setItem('sessionsCompleted', sessionsCompleted.toString());
            updateProgressDisplay();
        }

        function selectDuration(seconds) {
            selectedDuration = seconds;
            
            // Update UI
            document.querySelectorAll('.duration-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            // Update estimated time
            updateEstimatedTime();
        }

        function updateEstimatedTime() {
            let totalSeconds = 0;
            
            exercises.forEach(exercise => {
                totalSeconds += selectedDuration;
                totalSeconds += 5; // rest between exercises
            });
            
            const minutes = Math.ceil(totalSeconds / 60);
            document.getElementById('estimated-time').textContent = `~${minutes}`;
        }

        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function renderExerciseList() {
            const listContainer = document.getElementById('exercise-list-items');
            listContainer.innerHTML = '';
            
            workoutSequence.forEach((exercise, index) => {
                const item = document.createElement('div');
                item.className = 'exercise-item';
                if (index < currentExerciseIndex) {
                    item.classList.add('completed');
                } else if (index === currentExerciseIndex) {
                    item.classList.add('current');
                }
                
                item.innerHTML = `
                    <div class="exercise-item-icon">${index < currentExerciseIndex ? '‚úì' : index + 1}</div>
                    <div class="exercise-item-name">${exercise.name}</div>
                    <div class="exercise-item-duration">${selectedDuration}s</div>
                `;
                
                listContainer.appendChild(item);
            });
        }

        function startWorkout() {
            // Shuffle exercises
            workoutSequence = shuffle([...exercises]);
            currentExerciseIndex = 0;
            totalElapsedTime = 0;
            
            // Switch to workout screen
            document.getElementById('setup-screen').classList.remove('active');
            document.getElementById('workout-screen').classList.add('active');
            
            // Render exercise list
            renderExerciseList();
            
            // Start first exercise
            startExercise();
        }

        function startExercise() {
            const exercise = workoutSequence[currentExerciseIndex];
            currentPatternIndex = 0;
            exerciseStartTime = Date.now();
            exerciseElapsedTime = 0;
            isPaused = false;
            isResting = false;
            totalExerciseTime = selectedDuration;
            
            // Update UI
            document.getElementById('exercise-progress').textContent = 
                `–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ${currentExerciseIndex + 1} –∏–∑ ${workoutSequence.length}`;
            document.getElementById('exercise-name').textContent = exercise.name;
            document.getElementById('exercise-description').textContent = exercise.description;
            
            // Update exercise list
            renderExerciseList();
            
            // Start with countdown
            startCountdown();
        }

        function startCountdown() {
            let countdown = 3;
            const circle = document.getElementById('timer-circle');
            circle.className = 'timer-circle rest';
            
            updateDisplay('–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å', countdown);
            updateCircularProgress(1); // Full circle for countdown
            
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    updateDisplay('–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å', countdown);
                } else {
                    clearInterval(countdownInterval);
                    startPattern();
                }
            }, 1000);
        }

        function startPattern() {
            const exercise = workoutSequence[currentExerciseIndex];
            const step = exercise.pattern[currentPatternIndex];
            
            timeRemaining = step.duration;
            
            // Update circle style
            const circle = document.getElementById('timer-circle');
            circle.className = `timer-circle ${step.phase}`;
            
            // Trigger vibration on squeeze
            if (step.phase === 'squeeze' && 'vibrate' in navigator) {
                navigator.vibrate(200);
            }
            
            updateDisplay(step.label, timeRemaining);
            
            // Start timer
            timerInterval = setInterval(() => {
                if (!isPaused) {
                    timeRemaining--;
                    exerciseElapsedTime++;
                    totalElapsedTime++;
                    
                    updateDisplay(step.label, timeRemaining);
                    updateCircularProgress((totalExerciseTime - exerciseElapsedTime) / totalExerciseTime);
                    
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        nextStep();
                    }
                }
            }, 1000);
        }

        function nextStep() {
            const exercise = workoutSequence[currentExerciseIndex];
            
            // Check if exercise duration is reached
            if (exerciseElapsedTime >= selectedDuration) {
                // Exercise complete, start rest period
                startRestPeriod();
            } else {
                // Move to next pattern step
                currentPatternIndex = (currentPatternIndex + 1) % exercise.pattern.length;
                startPattern();
            }
        }

        function startRestPeriod() {
            isResting = true;
            timeRemaining = 5;
            
            const circle = document.getElementById('timer-circle');
            circle.className = 'timer-circle rest';
            
            updateDisplay('–û—Ç–¥—ã—Ö', timeRemaining);
            updateCircularProgress(1); // Full circle for rest
            
            timerInterval = setInterval(() => {
                if (!isPaused) {
                    timeRemaining--;
                    totalElapsedTime++;
                    
                    updateDisplay('–û—Ç–¥—ã—Ö', timeRemaining);
                    
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        nextExercise();
                    }
                }
            }, 1000);
        }

        function nextExercise() {
            currentExerciseIndex++;
            
            if (currentExerciseIndex < workoutSequence.length) {
                startExercise();
            } else {
                completeWorkout();
            }
        }

        function skipExercise() {
            if (confirm('–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ?')) {
                clearInterval(timerInterval);
                if (isResting) {
                    nextExercise();
                } else {
                    startRestPeriod();
                }
            }
        }

        function togglePause() {
            isPaused = !isPaused;
            const btn = document.getElementById('pause-btn');
            btn.textContent = isPaused ? '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '–ü–∞—É–∑–∞';
        }

        function updateDisplay(label, seconds) {
            document.getElementById('phase-label').textContent = label;
            document.getElementById('time-display').textContent = seconds;
        }

        function updateCircularProgress(progress) {
            const progressCircle = document.getElementById('progress-circle');
            const offset = circumference * (1 - progress);
            progressCircle.style.strokeDashoffset = offset;
        }

        function completeWorkout() {
            // Save progress
            saveProgress();
            
            // Switch to completion screen
            document.getElementById('workout-screen').classList.remove('active');
            document.getElementById('completion-screen').classList.add('active');
            
            // Update stats
            const minutes = Math.floor(totalElapsedTime / 60);
            const seconds = totalElapsedTime % 60;
            document.getElementById('total-time').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function restartWorkout() {
            // Reset to setup screen
            document.getElementById('completion-screen').classList.remove('active');
            document.getElementById('setup-screen').classList.add('active');
        }

        // Initialize
        loadProgress();
        updateEstimatedTime();
    </script>
</body>
</html>
